사용자 모드 후킹이란

윈도우 후킹에는 크게 사용자 모드와 커널 모드의 후킹이 있다.

사용자 모드의 후킹에는 IAT 후킹, 인라인 후킹이 있으며 IAT후킹은 IAT 테이블을 수정하여 구현할 수 있고 인라인 후킹은 함수의 시작 부분을 분기를 사용하여 흐름을 변경하는 것이다. 단순히 main 함수에서 사용한 WinAPI를 후킹할 때는 후킹 코드를 IAT 후킹과 인라인 후킹 방식으로 작성하고 프로그램을 실행하면 되지만 만약 현재 실행중인 프로세스에서 사용된 WinAPI를 후킹하고 싶은 거라면 후킹을 수행할 DLL을 인라인 후킹 혹은 IAT 후킹 방식으로 코드를 작성하고 DLL 인젝션을 통해 사용자 모드 프로세스에서 사용하는 가상메모리의 사용자 주소 공간에 있는 코드에 삽입하면 된다.

